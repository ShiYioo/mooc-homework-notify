spring:
  application:
    name: mooc-work-nodify

  # 邮件配置
  mail:
    host: smtp.163.com              # 邮件服务器地址，如：smtp.qq.com, smtp.163.com, smtp.gmail.com
    port: 465                       # SSL端口（163/QQ邮箱使用465，Gmail使用587）
    username: your-email@163.com    # 发件人邮箱
    password: your-auth-code        # 邮箱授权码（不是登录密码，需要在邮箱设置中开启SMTP并获取授权码）
    protocol: smtps                 # 使用SSL协议
    properties:
      mail:
        smtp:
          auth: true
          ssl:
            enable: true
          socketFactory:
            class: javax.net.ssl.SSLSocketFactory
            port: 465
    default-encoding: UTF-8

# MOOC平台配置
mooc:
  # ==================== 登录方式选择 ====================
  # 💡 推荐使用「方式二：自动登录」，无需手动配置Cookie

  # 方式一：手动配置Cookie（不推荐，需要每10天手动更新）
  # 方式二：自动登录获取Cookie（推荐，全自动维护）

  # Cookie信息（仅在未启用自动登录时需要配置）
  # ⚠️ 如果 login.enabled=true，此字段留空即可，系统会自动获取
  # 手动获取方法：
  # 1. 登录 https://www.icourse163.org/
  # 2. 按F12打开开发者工具
  # 3. 切换到Network标签
  # 4. 刷新页面，选择任意请求
  # 5. 在Request Headers中找到Cookie字段，复制完整值
  cookie: ""  # 启用自动登录时留空

  # CSRF密钥（从Cookie中的NTESSTUDYSI字段获取）
  # ⚠️ 如果 login.enabled=true，此字段留空即可，系统会自动提取
  csrf-key: ""  # 启用自动登录时留空

  # ==================== 自动登录配置（强烈推荐） ====================
  login:
    # 是否启用无头浏览器自动登录
    # ✅ true: 使用邮箱密码自动登录，Cookie永久自动维护（推荐）
    # ❌ false: 需要手动配置上面的Cookie，每10天更新一次
    enabled: true

    # MOOC登录邮箱
    email: "your-email@163.com"

    # MOOC登录密码（明文，请妥善保管配置文件）
    password: "your-password"

    # Cookie缓存文件路径（自动登录后会保存Cookie，避免频繁登录）
    # 注意：Cookie会一直使用，直到MOOC API返回为空时才会自动重新登录
    # 默认保存在JAR包同目录的data文件夹下
    cookie-cache-file: "./data/mooc_cookies.json"


    # 浏览器配置
    browser:
      # 是否启用无头模式（后台运行，不显示浏览器窗口）
      # 开发调试时可设置为false查看登录过程
      headless: true

      # 浏览器操作超时时间（毫秒）
      timeout: 30000

      # 登录页面URL（通常不需要修改）
      login-url: "https://www.icourse163.org/member/login.htm"

  # ==================== 课程监控配置 ====================

  # 课程学期ID列表（支持监控多个课程）
  # 获取方法：
  # 1. 进入课程页面
  # 2. 在开发者工具Network中找到 getLastLearnedMocTermDto.rpc 请求
  # 3. 查看请求参数中的termId值
  # 或者从课程URL中获取：https://www.icourse163.org/learn/XXX?tid=1475440469
  term-ids:
    - "1475440469"  # 示例：数据库系统原理课程
    # - "1234567890"  # 可以添加更多课程ID

  # MOOC API基础URL（通常不需要修改）
  api-base-url: "https://www.icourse163.org/web/j/courseBean.getLastLearnedMocTermDto.rpc"

  # 作业提醒时间点（距离截止时间的小时数）
  # 默认在作业截止前24小时和1小时各提醒一次
  reminder-hours:
    - 24   # 截止前24小时提醒
    - 1    # 截止前1小时紧急提醒
    # - 72   # 可以添加更多提醒时间点，如截止前3天
    # - 2    # 截止前2小时


# 邮件通知配置
notification:
  email:
    enabled: true  # 是否启用邮件通知（false则不发送邮件）

    # 收件人邮箱列表（支持多个收件人）
    recipients:
      - "student1@example.com"
      # - "student2@example.com"  # 可以添加多个收件人

    subject-prefix: "[MOOC作业提醒]"  # 邮件主题前缀

# 日志配置
logging:
  level:
    root: INFO
    org.shiyi.moocworknodify: INFO      # 应用日志级别
    org.springframework.mail: DEBUG     # 邮件发送日志（调试用）
  file:
    name: logs/mooc-work-notify.log     # 日志文件路径

